<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Hello Analytics Reporting API V4</title>
<meta name="google-signin-client_id" content="500269036967-pkchie0p21bgu51dcqtdlmjbmdoji51r.apps.googleusercontent.com">
<meta name="google-signin-scope"
	content="https://www.googleapis.com/auth/analytics.readonly">
</head>
<body>
	<h1>Hello Analytics Reporting API V4</h1>

	<!-- The Sign-in button. This will run `queryReports()` on success. -->
	<p class="g-signin2" data-onsuccess="queryReports"></p>

	<!-- The API response will be printed here. -->
	<textarea cols="80" rows="20" id="query-output"></textarea>

	<!-- Google Analytics -->
	<script>
		(function(i, s, o, g, r, a, m) {
			i['GoogleAnalyticsObject'] = r;
			i[r] = i[r] || function() {
				(i[r].q = i[r].q || []).push(arguments)
			}, i[r].l = 1 * new Date();
			a = s.createElement(o), m = s.getElementsByTagName(o)[0];
			a.async = 1;
			a.src = g;
			m.parentNode.insertBefore(a, m)
		})(window, document, 'script',
				'https://www.google-analytics.com/analytics.js', 'ga');

		ga('create', 'UA-XXXXX-Y', 'auto');
		ga('send', 'pageview');
		
		
		ga(function(tracker) {
			  var clientId = tracker.get('clientId');
			alert(clientId);
			}); 

		
	</script>
	
	<script>
		// Replace with your view ID.
		var VIEW_ID = '169860540';

		// Query the API and print the results to the page.
		function queryReports() {
			gapi.client.request({
				path : '/v4/reports:batchGet',
				root : 'https://analyticsreporting.googleapis.com/',
				method : 'POST',
				body : {
					reportRequests : [ {
						viewId : VIEW_ID,
						dateRanges : [ {
							startDate : 'today',
							endDate : 'today'
						} ],
						dimensions: [
                            {
                                name: 'ga:eventLabel'
                            }
                        ],
						metrics: [
                            {
                                expression: 'ga:totalEvents',
                            }
                        ],
						filtersExpression: 'ga:eventCategory==formsubmit,ga:eventAction==submit',
					} ]
				}
			}).then(displayResults, console.error.bind(console));
		}

		function displayResults(response) {
			var formattedJson = JSON.stringify(response.result, null, 2);
			document.getElementById('query-output').value = formattedJson;
		}
	</script>

	<!-- Load the JavaScript API client and Sign-in library. -->
	<script src="https://apis.google.com/js/client:platform.js"></script>
</body>
</html>